"use strict";(self["webpackChunkrx"]=self["webpackChunkrx"]||[]).push([[98],{7273:function(t,s,e){e.d(s,{Z:function(){return n}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"order-item"},[s("div",{staticClass:"cell-item-box"},[s("div",{staticClass:"pro-info-box"},[t._m(0),s("div",{staticClass:"pro-info fl"},[s("div",{staticClass:"pro-info-text"},[s("div",{staticClass:"names clearfix"},[s("div",{staticClass:"pro-name fl"},[t._v(t._s(t.item.name))]),s("div",{staticClass:"pro-rule fl"},[t._v(t._s(t.item.rule))])]),s("div",{staticClass:"pro-enname"},[t._v(t._s(t.item.enname))])]),s("div",{staticClass:"pro-count-box clearfix"},[s("div",{staticClass:"pro-price fl"},[t._v("￥"+t._s(t.item.price))]),s("div",{staticClass:"step-box fr"},[t._v(" x "+t._s(t.item.count))])])])])])])},a=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"pro-img fl"},[s("img",{staticClass:"auto_img",attrs:{src:"http://www.kangliuyong.com:10002/images/product_large/IMG_0384_02.jpg",alt:""}})])}],r={name:"OrderItem",props:{item:{type:Object,default(){return{name:"名称",rule:"规格",enname:"英文名称",price:0,count:1}}}}},d=r,o=e(1001),l=(0,o.Z)(d,i,a,!1,null,"3bde32bf",null),n=l.exports},3098:function(t,s,e){e.r(s),e.d(s,{default:function(){return m}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"pay"},[s("van-nav-bar",{attrs:{title:"订单结算","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":t.onClickLeft}}),s("div",{staticClass:"pay-box"},[s("div",{staticClass:"select-address"},[s("div",[s("span",{on:{click:t.showSelectAddressList}},[t._v(" 选择地址")]),s("van-icon",{staticClass:"arrow",attrs:{name:"arrow"}})],1),s("div",{staticClass:"user-box"},[s("div",{staticClass:"user-info"},[s("div",{staticClass:"user-name"},[t._v(t._s(t.currentAddress.name))]),s("div",{staticClass:"user-phone"},[t._v(t._s(t.currentAddress.tel))]),t.currentAddress.isDefault?s("div",{staticClass:"default-address"},[t._v(" 默认 ")]):t._e()]),s("div",{staticClass:"detail-address"},[t._v(t._s(t.currentAddress.addressDetail))])])]),s("div",{staticClass:"order-info"},[s("OrderList",{attrs:{"info-title-left":"订单信息",count:t.productInfo.count,total:t.productInfo.total,date:t._f("formatDate")(t.productInfo.date,"yyyy-MM-dd hh:mm:ss")}},t._l(t.products,(function(t,e){return s("OrderItem",{key:e,attrs:{item:t}})})),1)],1)]),s("div",{staticClass:"btn-box"},[s("van-button",{attrs:{type:"primary",block:"",round:"",color:"#00f"},on:{click:t.payBox}},[t._v("立即结算")])],1),s("van-popup",{attrs:{position:"bottom","is-link":"",closeable:""},model:{value:t.isOpen,callback:function(s){t.isOpen=s},expression:"isOpen"}},[s("div",{staticClass:"address-title"},[t._v("选择地址")]),s("van-address-list",{attrs:{"default-tag-text":"默认",list:t.list},on:{add:t.NewAddress,select:t.selectAddress}})],1)],1)},a=[],r=function(){var t=this,s=t._self._c;return s("div",{staticClass:"order-list"},[s("div",{staticClass:"pro-box"},[s("div",{staticClass:"info-boxs clearfix"},[s("div",{staticClass:"info-title fl"},[t._v(t._s(t.infoTitleLeft))]),t._m(0)]),s("div",[s("div",{staticClass:"cell-list"},[t._t("default")],2),s("div",{staticClass:"bottom-info"},[t._m(1),s("div",{staticClass:"date"},[t._v(t._s(t.date))]),s("div",{staticClass:"clearfix"},[s("div",{staticClass:"fl"},[t._v("共计"+t._s(t.count)+"件")]),s("div",{staticClass:"fr"},[t._v("合计 ￥ "+t._s(t.total))])])])])])])},d=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"re-info fl"},[s("div",{staticClass:"clearfix"})])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"circle clearfix"},[s("div",{staticClass:"circle-box circle-left"}),s("div",{staticClass:"circle-box circle-right"})])}],o={name:"OrderLists",props:{infoTitleLeft:{type:String,default:"订单信息"},isRight:{type:Boolean,default:!1},date:{type:String,default:"1970-01-01 00:00:00"},count:{type:Number,default:0},total:{type:[Number,String],default:0}},data(){return{}},created(){},methods:{confirmReceive(){this.$emit("confirm-receive")}}},l=o,n=e(1001),c=(0,n.Z)(l,r,d,!1,null,"063b74c8",null),u=c.exports,p=e(7273),f={name:"Pay",components:{OrderItem:p.Z,OrderList:u},data(){return{isOpen:!1,sids:[],products:[],productInfo:{count:0,total:0},chosenAddressId:"",list:[],currentAddress:{}}},created(){this.sids=this.$route.query.sids.split("-"),this.getShopbagBySids(),this.getAddressData()},methods:{showSelectAddressList(){this.isOpen=!0},selectAddress(t,s){this.isOpen=!1,this.currentAddress=t,console.log(t)},onClickLeft(){this.$router.back(-1)},getShopbagBySids(){let t=localStorage.getItem("__tk");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.axios({methods:"GET",url:"/commitShopcart",params:{appkey:this.appkey,tokenString:t,sids:JSON.stringify(this.sids)}}).then((t=>{if(console.log(t),700==t.data.code)this.$router.push({name:"Login"});else if(5e4==t.data.code){if(0==t.data.result.length)return this.$router.push({name:"Home"});t.data.result.map((t=>{this.productInfo.count+=t.count,this.productInfo.total+=t.count*t.price,this.productInfo.date=t.updated_at})),this.products=t.data.result}else this.$toast(t.data.mag)}))},getAddressData(){let t=localStorage.getItem("__tk");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.axios({methods:"GET",url:"/findAddress",params:{appkey:this.appkey,tokenString:t}}).then((t=>{console.log(t),700==t.data.code?this.$router.push({name:"Login"}):2e4==t.data.code&&(t.data.result.map((t=>{t.isDefault,Boolean(t.isDefault),t.id,t.aid,t.address=`${t.province}${t.city}${t.county}${t.addressDetail}`,t.isDefault&&(this.chosenAddressId=t.aid,this.currentAddress=t)})),this.list=t.data.result)}))},NewAddress(){this.$router.push({name:"NewAddress"})},pay(){let t=localStorage.getItem("__tk");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.axios({method:"POST",url:"/pay",data:{appkey:this.appkey,tokenString:t,sids:JSON.stringify(this.sids),phone:this.currentAddress.tel,address:this.currentAddress.address,receiver:this.currentAddress.name}}).then((t=>{console.log(t),700==t.data.code?this.$router.push({name:"Login"}):(this.$toast(t.data.msg),setTimeout((()=>{this.$router.push({name:"Order"})})))}))},payBox(){this.chosenAddressId?this.$dialog.confirm({title:"确认订单",message:"是否立即结算?"}).then((()=>{this.pay()})):this.$toast("请选择地址")}}},h=f,v=(0,n.Z)(h,i,a,!1,null,"5c54eb2c",null),m=v.exports}}]);
//# sourceMappingURL=98.1a0c5964.js.map